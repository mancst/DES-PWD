var g_dmtChartColor=["#FF4949","#FFA74D","#FFEA51","#4BF0FF","#44AFF0","#4E82FF","#584BFF","#BE4DFF","#F845F1"],g_dmtChartStyle="dark",g_dmtChartWidth,g_dmtLastLeftShow=null,g_dmtLastType=null,g_dmtLastTypeId=null,g_dmtChartMargin=8,g_dmtChartMinWidth=460,g_dmtChartHeight=320,g_dmtSingleChartMinWidth=1100,g_dmtSingleChartHeight=520,g_all_charts=new Array,g_dmtRedrawChartCountShowProc=5,g_attr_type_list=null,g_PluginMargin=10,ATTR_VALUE_TYPE_COMMON=0,ATTR_VALUE_TYPE_PERCENT=1,ATTR_VALUE_TYPE_DIVISION_100=2;ATTR_VALUE_TYPE_MULTI_1024=3;var ATTR_CHART_TYPE_LINE=0,ATTR_CHART_TYPE_LINE_AREA=1,ATTR_CHART_TYPE_BAR=6,ATTR_CHART_TYPE_PIE=12,ATTR_CHART_TYPE_SCATTER=18,ATTR_CHART_TYPE_GEO=24,ATTR_CHART_TYPE_GRAPH=30,ATTR_CHART_TYPE_TREE=36,ATTR_CHART_TYPE_TREEMAP=42,ATTR_CHART_TYPE_FUNNEL=48,ATTR_CHART_TYPE_GAUGE=54,SUM_REPORT_M=1,SUM_REPORT_MIN=2,EX_REPORT=3,SUM_REPORT_MAX=4,SUM_REPORT_TOTAL=5,STR_REPORT_D=6,STR_REPORT_D_IP=7,DATA_USE_LAST=8;function dmtMathtrunc(t){return"function"!=typeof Math.trunc?Math.round(t):Math.trunc(t)}function dmtGetHumanTime(t){var e="";return 86400<=t&&(e+=dmtMathtrunc(t/86400)+"天 ",t%=86400),3600<=t&&(e+=dmtMathtrunc(t/3600)+"小时 ",t%=3600),60<=t&&(e+=dmtMathtrunc(t/60)+"分钟 ",t%=60),1<=t&&(e+=dmtMathtrunc(t)+"秒 "),e}var g_pluginShowWidth=0,g_pluginShowHeight=0;function dmtSetPluginShowWH(){var t=DWZ.ui.sbar?$("#sidebar").width():35,e=$(window).width()-t,a=!1;e!=g_pluginShowWidth&&(g_pluginShowWidth=e,a=!0);var r=$(window).height()-$("header").outerHeight(!0)-$("footer").outerHeight(!0)-$(".tabsPageHeader").outerHeight(!0);return g_pluginShowHeight!=r&&(g_pluginShowHeight=r,a=!0),a}function dmtSetPluginMarginInfo(t){var e=DWZ.ui.sbar?$("#sidebar").width()+10:24,a=$(window).width()-e-20-45,r=a%452,i=dmtMathtrunc(a/452),n=dmtMathtrunc(r/i/2);if(n==g_PluginMargin)return!1;if(g_PluginMargin=n,void 0===t)return!0;return"dmt_plugin_open"!=t?dmtJsBugReport("dmt.comm.js","dmtSetPluginMarginInfo","unknow plugin tab:"+t):$("#dpopen_plugin_list").children().each(function(){$(this).css("margin","10px "+g_PluginMargin+"px")}),!0}function dmtSetChartOptionByAttrInfo(t,e,a){var r="",i=0;void 0!==a.showtype&&(r=a.showtype),void 0!==a.day_type&&(i=a.day_type),t.chart_type==ATTR_CHART_TYPE_BAR?(e.series[0].type="bar",1==i&&(e.series[1].type="bar",e.series[2].type="bar")):t.chart_type==ATTR_CHART_TYPE_LINE_AREA?(e.series[0].type="line",e.series[0].areaStyle={},e.series[0].stack="stack_line",1==i&&(e.series[1].type="line",e.series[1].areaStyle={},e.series[1].stack="stack_line",e.series[2].type="line",e.series[2].areaStyle={},e.series[2].stack="stack_line")):(e.series[0].type="line",e.series[0].areaStyle=null,e.series[0].stack=null,1==i&&(e.series[1].type="line",e.series[1].areaStyle=null,e.series[1].stack=null,e.series[2].type="line",e.series[2].areaStyle=null,e.series[2].stack=null)),t.value_type==ATTR_VALUE_TYPE_PERCENT?(e.yAxis.axisLabel.formatter="{value}%",e.tooltip.formatter=function(t,e,a){var r=t[0].axisValueLabel+"<br />"+t[0].seriesName+": "+t[0].value[1]+"%";return 3==t.length&&(r+="<br />"+t[1].seriesName+": "+t[1].value[1]+"%",r+="<br />"+t[2].seriesName+": "+t[2].value[1]+"%"),r}):t.value_type==ATTR_VALUE_TYPE_DIVISION_100?(e.yAxis.axisLabel.formatter=function(t,e){return(t/100).toFixed(2)},e.tooltip.formatter=function(t,e,a){var r=t[0].value[1]/100,i=t[0].axisValueLabel+"<br />"+t[0].seriesName+": "+r.toFixed(2);return 3==t.length&&(i+="<br />"+t[1].seriesName+": "+(t[1].value[1]/100).toFixed(2),i+="<br />"+t[2].seriesName+": "+(t[2].value[1]/100).toFixed(2)),i}):t.value_type==ATTR_VALUE_TYPE_MULTI_1024?(e.yAxis.axisLabel.formatter=function(t,e){return dmtGetHumanReadFixed2ByKB(t)},e.tooltip.formatter=function(t,e,a){var r=t[0].axisValueLabel+"<br />"+t[0].seriesName+": "+dmtGetHumanReadFixed2ByKB(t[0].value[1]);return 3==t.length&&(r+="<br />"+t[1].seriesName+": "+dmtGetHumanReadFixed2ByKB(t[1].value[1]),r+="<br />"+t[2].seriesName+": "+dmtGetHumanReadFixed2ByKB(t[2].value[1])),r}):(e.yAxis.axisLabel.formatter=function(t,e){return"site"==r?t:dmtGetHumanReadFixed2(t)},e.tooltip.formatter=function(t,e,a){var r=t[0].axisValueLabel+"<br />"+t[0].seriesName+": "+dmtGetHumanReadFixed2(t[0].value[1]);return 3==t.length&&(r+="<br />"+t[1].seriesName+": "+dmtGetHumanReadFixed2(t[1].value[1]),r+="<br />"+t[2].seriesName+": "+dmtGetHumanReadFixed2(t[2].value[1])),r})}function dmtIsExplorerSupport(){return!0}function dmtGetCookie(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?unescape(e[2]):null}function dmtCheckFull(){var t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;return null!=t&&t}function dmtToggleFullScreen(t){var e,a,r,i="";return dmtCheckFull()?((e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.webkitExitFullscreen)?e.call(document):void 0!==window.ActiveXObject&&null!==(r=new ActiveXObject("WScript.Shell"))&&r.SendKeys("{F11}"),i="no"):(i="error",(a=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen)?(a.call(t),i="yes"):void 0!==window.ActiveXObject&&null!==(r=new ActiveXObject("WScript.Shell"))&&(r.SendKeys("{F11}"),i="yes")),i}function dmtDelCookie(t){var e=new Date(new Date-6048e5),a=dmtGetCookie(t);null!=a&&(document.cookie=t+"="+a+"; expires="+e.toUTCString()+";path=/")}function dmtSetChartSize(){var t=DWZ.ui.sbar?$("#sidebar").width()+10:24,e=$(window).width()-t-5-45;void 0!==g_dmtLastLeftShow&&g_dmtLastLeftShow&&(e-=$(".chartLeftMenu").width());var a=g_dmtChartMinWidth+2*g_dmtChartMargin,r=e%a,i=dmtMathtrunc(e/a),n=dmtMathtrunc(r/i);g_dmtChartWidth=g_dmtChartMinWidth+n}function dmtSetRedrawChartsInfo(t,e,a){g_dmtLastTypeId=t,g_dmtLastType=e,g_dmtLastLeftShow=a}function dmtRedrawCharts(type_id,type,isLeftShow){var js;if(void 0!==type_id?(g_dmtLastTypeId=type_id,g_dmtLastType=type,g_dmtLastLeftShow=isLeftShow):(type_id=g_dmtLastTypeId,type=g_dmtLastType,isLeftShow=g_dmtLastLeftShow),null!=type_id)if("plugin"!=type){if(dmtSetChartSize(),void 0!==g_all_charts){var keystr="_"+type_id+type,iNeedRedraw=0;for(ct in g_all_charts)if("string"==typeof ct&&ct.match(keystr)){if(void 0!==g_all_charts[ct].setwidth&&g_all_charts[ct].setwidth==g_dmtChartWidth)return;iNeedRedraw++}var rchart=$("#my_background,#my_progressBar");g_dmtRedrawChartCountShowProc<iNeedRedraw&&($("#my_progressBar font").text("图表重绘中, 请稍等..."),rchart.show()),setTimeout(function(){for(ct in g_all_charts)ct.match(keystr)&&($("#"+ct).css("width",g_dmtChartWidth),g_all_charts[ct].resize(),g_all_charts[ct].setwidth=g_dmtChartWidth);rchart.hide()},5)}}else dmtSetPluginShowWH()&&(js="if(typeof dmtPluginShowOnChane_"+type_id+" == 'function') ",js+="dmtPluginShowOnChane_"+type_id+"();",eval(js))}function dmtSetChartNewDetailInfo(t,e){var a,r;void 0!==g_all_charts[e]&&void 0!==g_all_charts[e].warnInfo?(g_all_charts[e].warnInfo.warn_flag=t.warn_flag,a="",g_all_charts[e].warnInfo.value_type==ATTR_VALUE_TYPE_PERCENT&&(a="%"),1&t.warn_flag?g_all_charts[e].warnInfo.warn_max=t.warn_max+a:g_all_charts[e].warnInfo.warn_max=null,2&t.warn_flag?g_all_charts[e].warnInfo.warn_min=t.warn_min+a:g_all_charts[e].warnInfo.warn_min=null,4&t.warn_flag?g_all_charts[e].warnInfo.warn_wave=t.warn_wave+"% ":g_all_charts[e].warnInfo.warn_wave=null,r={toolbox:{feature:{myUnMaskWarningData:{show:!0},myMaskWarningData:{show:!0},mySetWarningData:{show:!0}}}},g_all_charts[e].warnInfo.warn_cfg_id=t.warn_config_id,32&t.warn_flag?(r.toolbox.feature.myUnMaskWarningData.show=!0,r.toolbox.feature.mySetWarningData.show=!1,r.toolbox.feature.myMaskWarningData.show=!1,g_all_charts[e].warnInfo.mask=0):(r.toolbox.feature.myUnMaskWarningData.show=!1,r.toolbox.feature.mySetWarningData.show=!0,1&t.warn_flag||2&t.warn_flag||4&t.warn_flag?(r.toolbox.feature.myMaskWarningData.show=!0,g_all_charts[e].warnInfo.mask=1):(r.toolbox.feature.myMaskWarningData.show=!1,g_all_charts[e].warnInfo.mask=0)),g_all_charts[e].setOption(r),alertMsg.info("变更监控点提示配置成功")):alertMsg.error("javascript 脚本错误, 未找到图表信息:"+e)}function dmtMaskWarnConfig(t,e,a){var r,i,n={},o="attr_"+a+"_"+e+t;void 0!==g_all_charts[o]&&void 0!==g_all_charts[o].warnInfo?(r=g_all_charts[o].warnInfo,n.action="mask_warn_config",n.mask=r.mask,n.warn_cfg_id=r.warn_cfg_id,i=(void 0!==g_siteInfo.cgi_path&&""!=g_siteInfo.cgi_path?g_siteInfo.cgi_path:r.cgi_path)+"mt_slog_warn",$.ajax({url:i,data:n,global:!1,success:function(t){dmtFirstDealAjaxResponse(t)||(200==t.statusCode?dmtSetChartNewDetailInfo(t,o):alertMsg.warn(DWZ.msg(t.msgid)))},dataType:"json"})):alertMsg.error("javascript 脚本错误, 无提示信息:"+o)}function dmtSetWarnConfig(t,e,a){var r,i,n,o,l,s,_="attr_"+a+"_"+e+t;void 0!==g_all_charts[_]&&void 0!==g_all_charts[_].warnInfo?(r=g_all_charts[_].warnInfo,i=(void 0!==g_siteInfo.cgi_path&&""!=g_siteInfo.cgi_path?g_siteInfo.cgi_path:r.cgi_path)+"/mt_slog_warn?action=chart_set_attr_warn",n=r.attr_name,i+="&warn_cfg_id="+r.warn_cfg_id,i+="&value_type="+r.value_type,i+="&attr_name="+n,i+="&warn_type_id="+e,i+="&warn_attr_id="+a,i+="&warn_type="+t,o="dc_dlg_set_warn_"+e+"_"+a,l=$.parseJSON('{"mask":true,"maxable":false,"height":260,"width":530,"resizable":false}'),s="",s="view"==t?"设置视图提示：视图【"+e+"】监控点【"+a+"_"+n+"】":"设置服务器提示：服务器【"+e+"】监控点【"+a+"_"+n+"】",$.pdialog.open(i,o,s,l)):alertMsg.error("javascript 脚本错误, 无提示信息:"+_)}function dmtShowPluginSingleAttr(t,e,a,r,i,n,o){var l=t+"/mt_slog_showview?action=show_plugin_single_attr";l+="&plugin_id="+r,l+="&cust_date="+e,l+="&type="+a,l+="&attr_id="+i,l+="&plugin_show_name="+n;var s="pluginattr_"+i,_="监控点【"+i+"_"+o+"】",d='<img src="'+g_siteInfo.doc_path+'images/color_swatch.png" />'+_;navTab.openTab(s,l,{title:_,titleHtml:d,fresh:!0,global:!1})}function dmtShowSingle(t,e,a,r,i,n,o){var l=r+"/mt_slog_showview?action=show_single";l+="&type_id="+n,l+="&cust_date="+t,l+="&show_type="+i,l+="&attr_id="+o,l+="&show_single_type="+a;var s="dc_dlg_show_single_"+n+"_"+o,_='{"mask":true,"maxable":false,"height":';_+=g_dmtSingleChartHeight,_+=',"width":'+g_dmtSingleChartMinWidth+',"resizable":true}';var d=$.parseJSON(_),c="",c="view"==i?"视图【"+n+"】监控点【"+o+"_"+e+"】":"服务器【"+n+"】监控点【"+o+"_"+e+"】";c+=" - 上报数据查看",$.pdialog.open(l,s,c,d)}function dmtSetShowSingleSite(t,e,a,r,i){t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,i.name,a.show_single_type,a.cgi_path,e,a.site_id,i.id)}}function dmtGetDateStr(t,e){var a=new Date(t+60*(new Date).getTimezoneOffset()*1e3),r="";return void 0===e&&(r=a.getFullYear(),a.getMonth()<9?r+="-0"+(a.getMonth()+1):r+="-"+(a.getMonth()+1),a.getDate()<10?r+="-0"+a.getDate():r+="-"+a.getDate()),a.getHours()<10?r+=" 0"+a.getHours():r+=" "+a.getHours(),a.getMinutes()<10?r+=":0"+a.getMinutes():r+=":"+a.getMinutes(),r}function dmtSetViewChartInfo(t,e,a,r,i){i.rep_max=a.max,0<a.max&&(i.rep_min=a.min,i.rep_cur=a.cur,i.rep_total=a.total),0<a.cur&&(i.cur_date_time=e.date_time,i.cur_static_val=a.cur),i.attr_statics_time=r.static_time,i.attr_data_type=r.data_type,i.value_type=r.value_type,i.warn_flag=a.warn_flag,1&a.warn_flag&&(i.warn_max=a.warn_max),2&a.warn_flag&&(i.warn_min=a.warn_min),4&a.warn_flag&&(i.warn_wave=a.warn_wave)}function dmtShowChartDetailInfo(show_type,obj_type_id,attr_id){var cur_chart_idx="attr_"+attr_id+"_"+obj_type_id+show_type,warnInfo,chart_op,obj,obj,winfo,tl,op;void 0!==g_all_charts[cur_chart_idx]&&void 0!==g_all_charts[cur_chart_idx].warnInfo?(warnInfo=g_all_charts[cur_chart_idx].warnInfo,chart_op=g_all_charts[cur_chart_idx].getOption(),obj="",obj="view"==show_type?"视图【"+obj_type_id+"】"+eval("ds_view_name_"+obj_type_id):"machine"==show_type?"服务器【"+obj_type_id+"】"+eval("dsm_machine_name_"+obj_type_id):"pluginview"==show_type?"插件【"+obj_type_id+"】"+eval("ds_plugin_name_"+obj_type_id):"对象【"+obj_type_id+"】",0<warnInfo.rep_max?$(".dlg_chart_info_attr_data_info").text("最大值："+dmtShowChangeValue(warnInfo.rep_max)+"，最小值："+dmtShowChangeValue(warnInfo.rep_min)+"，累计值："+dmtShowChangeValue(warnInfo.rep_total)):$(".dlg_chart_info_attr_data_info").text("无上报"),void 0!==warnInfo.cur_static_val?$(".dlg_chart_info_attr_last_static_info").text("上报时间："+warnInfo.cur_date_time+"，上报值："+warnInfo.cur_static_val):warnInfo.attr_data_type==STR_REPORT_D||warnInfo.attr_data_type==STR_REPORT_D_IP?$(".dlg_chart_info_attr_last_static_info").text("上报字符串数："+warnInfo.str_count):$(".dlg_chart_info_attr_last_static_info").text("无上报"),winfo="",void 0!==warnInfo.warn_max&&null!=warnInfo.warn_max&&(winfo+=" 最大值："+warnInfo.warn_max),void 0!==warnInfo.warn_min&&null!=warnInfo.warn_min&&(winfo+=" 最小值："+warnInfo.warn_min),void 0!==warnInfo.warn_wave&&null!=warnInfo.warn_wave&&(winfo+=" 波动值："+warnInfo.warn_wave),""!=winfo?32&warnInfo.warn_flag&&(winfo+='&nbsp;&nbsp;<font color="red">提示已屏蔽</font>'):winfo="未配置提示信息",$(".dlg_chart_info_attr_warn_info").html(winfo),$(".dlg_chart_info_obj").text(obj),$(".dlg_chart_info_attr").text(chart_op.title[0].text+"，统计周期："+dmtShowHumanStaticTime(warnInfo.attr_statics_time)),tl='<i class="icon-file-text-alt icon-large"></i>'+chart_op.title[0].text+" - 图表概要信息",op={mask:!0,maxable:!1,height:260,width:500,resizable:!1,drawable:!0},$.pdialog.openLocal("dc_dlg_detail_chart_info","dc_dlg_detail_chart_info",tl,op)):alertMsg.error("javascript 脚本错误, 无概要信息:"+cur_chart_idx)}function dmtSetCustToolBox(t,e,a,r,i,n){var o;if("view"==e)t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,i.name,a.show_single_type,a.cgi_path,e,a.view_id,i.id)},o=a.view_id;else{if("pluginview"==e)return t.toolbox.feature.myUnMaskWarningData.show=!1,t.toolbox.feature.myMaskWarningData.show=!1,t.toolbox.feature.mySetWarningData=!1,t.toolbox.feature.myShowSingleData.show=!1,o=a.plugin_id,t.toolbox.feature.myPluginShowAttrMach.show=!0,t.toolbox.feature.myPluginShowAttrMach.onclick=function(){return dmtShowPluginSingleAttr(a.cgi_path,a.cust_date,a.type,o,i.id,a.plugin_show_name,i.name)},void(t.toolbox.feature.myShowDetailData.onclick=function(){return dmtShowChartDetailInfo(e,o,i.id)});t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,i.name,a.show_single_type,a.cgi_path,e,a.machine_id,i.id)},o=a.machine_id}24&r.warn_flag?n.warn_cfg_id=r.warn_config_id:n.warn_cfg_id=0,n.cgi_path=a.cgi_path,n.value_type=i.value_type,n.attr_name=i.name,32&r.warn_flag?(t.toolbox.feature.myUnMaskWarningData.show=!0,t.toolbox.feature.mySetWarningData.show=!1,t.toolbox.feature.myMaskWarningData.show=!1,n.mask=0):(t.toolbox.feature.myUnMaskWarningData.show=!1,t.toolbox.feature.mySetWarningData.show=!0,1&r.warn_flag||2&r.warn_flag||4&r.warn_flag?(t.toolbox.feature.myMaskWarningData.show=!0,n.mask=1):(t.toolbox.feature.myMaskWarningData.show=!1,n.mask=0)),t.toolbox.feature.myUnMaskWarningData.onclick=function(){return dmtMaskWarnConfig(e,o,i.id)},t.toolbox.feature.mySetWarningData.onclick=function(){return dmtSetWarnConfig(e,o,i.id)},t.toolbox.feature.myMaskWarningData.onclick=function(){return dmtMaskWarnConfig(e,o,i.id)},t.toolbox.feature.myShowDetailData.onclick=function(){return dmtShowChartDetailInfo(e,o,i.id)}}function dmtShowHumanStaticTime(t){switch(t){case 1:return"1分钟";case 5:return"5分钟";case 10:return"10分钟";case 15:return"15分钟";case 30:return"30分钟";case 60:return"1小时";case 120:return"2小时";case 180:return"3小时"}return"unknow"}function dmtGetTimeStamp(t){if(void 0===t||""==t)return 0;var e=t.split(" "),a=e[0].split("-"),r=+a[0],i=+a[1],n=+a[2],o=+(a=e[1].split(":"))[0],l=+a[1],s=+a[2];return new Date(r,i-1,n,o,l,s)/1e3}function dmtGetNaviAttrTypeTree(t){var e="";if(void 0===t.navi_has_type)return"";e="<li><a href='#'>"+t.name+"</a>",e+="<ul attr_type='"+t.type+"' >";for(var a=t.list,r=0;r<t.subcount&&r<a.length;r++)e+=dmtGetNaviAttrTypeTree(a[r]);return e+="</ul>",e+="</li>"}function dmtSetPluginViewChartNavigatioInfo(t,e){if(0<t.subcount){for(var a="",r=0;r<t.subcount&&r<listsub.length;r++)void 0!==listsub[r].navi_has_type&&(a+=dmtGetNaviAttrTypeTree(listsub[r]));$("#"+e+" ul").html(a)}else{var i=$("#"+e+" .navi_chart_text").text();$("#"+e+" .navi_chart_text").html('【<font color="gray"> 无 </font>】'+i)}}function dmtSetChartNavigatioInfo(t,e,a){for(var r=0,i=e.list,n=0;n<t.length;n++)for(var o=0;o<e.subcount&&o<i.length;o++)if("null"!=dmtGetTypeInfo(i[o],t[n])){r++;break}if(0<r){for(var l="",o=0;o<e.subcount&&o<i.length;o++)void 0!==i[o].navi_has_type&&(l+=dmtGetNaviAttrTypeTree(i[o]));$("#"+a+" ul").html(l)}else{var s=$("#"+a+" .navi_chart_text").text();$("#"+a+" .navi_chart_text").html('【<font color="gray"> 无 </font>】'+s)}}function dmtEncodeHTML(t){return 0===t.length?"":t.replace(/&#39;/g,"'").replace(/&#160;/g," ").replace(/&#92;/g,"\\").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/_r_n/g,"<br>").replace(/\\x0A/g,"<br>").replace(/\\x2F/g,"/").replace(/\\x3B/g,";").replace(/\\x22/g,'"').replace(/\\x3C/g,"<").replace(/\\x26/g,"&").replace(/\\x27/g,"'").replace(/\\x5C/g,"\\").replace(/\\x3E/g,">")}function dmtJsBugReport(t,e,a){}function dmtExport(t,e){alertMsg.confirm("确实要导出这些记录吗?",{okCall:function(){$.ajax({type:"post",url:t,data:{data:e},dataType:"json",global:!1,cache:!1,success:function(t){0!=t.statusCode?alertMsg.warn(t.msg):0==t.record_count?alertMsg.info("记录为空"):window.location=t.file},error:DWZ.ajaxError})}})}function dmtSetTypeTree(t){var e="<li><a href='#' name="+t.type+">"+t.name+"</a>";if(0==t.subcount)return e+="</li>";e+="<ul>";for(var a=t.list,r=0;r<t.subcount&&r<a.length;r++)e+=dmtSetTypeTree(a[r]);return e+="</ul>",e+="</li>"}function dmtGetTypeInfo(t,e){if(t.type==e)return t.navi_has_type=!0,t;for(var a=t.list,r=0;r<t.subcount&&r<a.length;r++){var i=dmtGetTypeInfo(a[r],e);if("null"!=i)return t.navi_has_type=!0,i}return"null"}function dmtGetAttrTypeList(t){for(var e=new Array,a=0,r=0;a<t.count&&a<t.list.length;a++){for(r=0;r<e.length&&t.list[a].attr_type!=e[r];r++);r>=e.length&&e.push(t.list[a].attr_type)}return e}function dmtGetAttrInfo(t,e){for(var a=t.list,r=0;r<t.count&&r<a.length;r++)if(a[r].id==e)return a[r];return"null"}function dmtJumpToAttrPic(t,e,a){var r="#"+t;if($(r).length<=0){var i=t.split("_");return"click"!=a&&$.isFunction(a)?(0==a(t)?alertMsg.info("监控点:"+i[1]+" 无数据上报"):alertMsg.info("监控点:"+i[1]+" 上报数据获取中..."),!1):(alertMsg.info("监控点:"+i[1]+" 无数据上报"),!1)}var n=$(e).scrollTop(),o=$(e).offset().top,l=$(r).offset().top-o+n;return $(e).animate({scrollTop:l}),!1}function dmtSetAttrList(t,e,a,r,i){var n,o=t.list,l="<li>",s="view"==a?(l+="<a href='#'>视图【"+t.view_id+"】已绑定的监控点列表",n="#ds_ct_attr_show_list_"+t.view_id,t.view_id):(l+="<a href='#'>机器【"+t.machine_id+"】有上报的监控点列表",n="#dsm_ct_attr_show_list_"+t.machine_id,t.machine_id);l+="(共:"+t.count+"个)</a>";for(var _=0;_<t.count&&_<o.length;_++)o[_].pushed=!1;for(_=0;_<t.count&&_<o.length;_++)if(!o[_].pushed){"site"!=a&&(l+="<ul>",l+="<li><a href='#'>"+e[o[_].attr_type]+"</a>"),l+="<ul>";for(var d,c=_;c<t.count&&c<o.length;c++){o[c].pushed||o[c].attr_type!=o[_].attr_type||(o[c].pushed=!0,l+="<li>",l+="<a onclick=\"dmtJumpToAttrPic('"+(d="attr_"+o[c].id+"_"+s+a)+"', '"+n+"', "+i+")\" href='#' ctid='"+d+"'>",l+=o[c].id+"_"+o[c].name,1==o[c].global&&(l+="<font color='blue'>&nbsp;[全局]</font>"),r.push(o[c].id),l+="</a>",l+="</li>")}l+="</ul>",l+="</li>",l+="</ul>"}return l+="</li>"}function dmtGetAttrIdList(t,e){for(var a=t.list,r=0;r<t.count&&r<a.length;r++)a[r].pushed=!1;for(r=0;r<t.count&&r<a.length;r++)if(!a[r].pushed)for(var i=r;i<t.count&&i<a.length;i++)a[i].pushed||a[i].attr_type!=a[r].attr_type||(a[i].pushed=!0,e.push(a[i].id))}function dmtShowChangeValue(t){if(1073741824<=t){var e=t/1073741824;return Math.round(100*parseFloat(e))/100+"G"}if(1048576<=t){e=t/1048576;return Math.round(100*parseFloat(e))/100+"M"}if(1024<=t){e=t/1024;return Math.round(100*parseFloat(e))/100+"K"}return t}function dmtSetStrAttrInfoChartIpGeo(t,e,a,r,i){var n={backgroundColor:"transparent",title:{x:"left",subtext:"",top:5,subtextStyle:{fontSize:12},textStyle:{fontSize:14},show:!0,text:""},tooltip:{trigger:"item",confine:!0,formatter:"{b}<br/>访问次数: {c}"},visualMap:{min:0,max:1e4,realtime:!0,calculable:!0,inRange:{color:["lightskyblue","yellow","orangered"]}},toolbox:{show:!0,orient:"horizontal",top:"top",zlevel:999,right:5,feature:{myPluginShowAttrMach:{show:!1,title:"查看该监控点在各机器的上报",icon:"image://"+g_siteInfo.doc_path+"images/color_swatch.png",onclick:function(){}},myShowDetailData:{show:!0,title:"图表概要信息",icon:"image://"+g_siteInfo.doc_path+"images/database_table.png",onclick:function(){}},dataView:{readOnly:!1},restore:{},saveAsImage:{show:!1}}},legend:{type:"scroll",orient:"vertical",left:"left",top:"40",show:!0},series:[{type:"map",mapType:"china",label:{show:!0},data:[],roam:!0,zlevel:999,backgroundColor:"transparent",itemStyle:{normal:{areaColor:"#4c60ff",borderColor:"#002097"},emphasis:{areaColor:"#293fff"}},geoIndex:0}]};$("#"+t).css("height",g_dmtChartHeight);var o=0,o="view"==i?(n.title.text="视图ID【"+r.view_id+"】监控点："+e.name,r.view_id):"pluginview"==i?(n.title.text="插件ID【"+r.plugin_id+"】监控点："+e.name,r.plugin_id):(n.title.text="服务器ID【"+r.machine_id+"】监控点："+e.name,r.machine_id);if(n.title.text+="-"+e.id,0<a.str_count){for(var l=0;l<a.str_count;l++)a.str_list[l].value;n.visualMap.max=a.str_list[0].value+100,n.series[0].data=a.str_list}else n.series[0].data=[],n.title.subtextStyle.color="red",n.title.subtextStyle.fontWeight="bold",n.title.subtext="暂无数据上报",n.title.x="center",n.title.top="center";var s=new Object;dmtSetViewChartInfo(i,r,a,e,s),s.value_type=e.value_type,s.attr_name=e.name,s.str_count=a.str_count,n.toolbox.feature.myShowDetailData.onclick=function(){return dmtShowChartDetailInfo(i,o,e.id)},g_all_charts[t]=echarts.init(document.getElementById(t),g_dmtChartStyle),g_all_charts[t].setOption(n),g_all_charts[t].setwidth=g_dmtChartWidth,g_all_charts[t].warnInfo=s}function dmtSetStrAttrInfoChart(t,e,a,r,i){var n={backgroundColor:"transparent",title:{x:"left",subtext:"",top:5,subtextStyle:{fontSize:12},textStyle:{fontSize:14},show:!0,text:""},tooltip:{trigger:"item",confine:!0,formatter:"上报字符串：{b}<br>上报值: {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",left:"left",top:"40",show:!0},toolbox:{show:!0,orient:"horizontal",top:"top",zlevel:999,right:5,feature:{myPluginShowAttrMach:{show:!1,title:"查看该监控点各机器的上报",icon:"image://"+g_siteInfo.doc_path+"images/color_swatch.png",onclick:function(){}},myShowDetailData:{show:!0,title:"图表概要信息",icon:"image://"+g_siteInfo.doc_path+"images/database_table.png",onclick:function(){}},dataView:{readOnly:!1},restore:{},saveAsImage:{show:!1}}},series:[{backgroundColor:"transparent",type:"pie",radius:"75%",zlevel:999,center:["70%","55%"],data:[],label:{show:!1,normal:{show:!1,position:"inside"},emphasis:{show:!1}},itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};$("#"+t).css("height",g_dmtChartHeight);var o=0,o="view"==i?(n.title.text="视图ID【"+r.view_id+"】监控点："+e.name,r.view_id):"pluginview"==i?(n.title.text="插件ID【"+r.plugin_id+"】监控点："+e.name,r.plugin_id):(n.title.text="服务器ID【"+r.machine_id+"】监控点："+e.name,r.machine_id);n.title.text+="-"+e.id,0<a.str_count?n.series[0].data=a.str_list:(n.series[0].data=[],n.title.subtextStyle.color="red",n.title.subtextStyle.fontWeight="bold",n.title.subtext="暂无数据上报",n.title.x="center",n.title.top="center");var l=new Object;dmtSetViewChartInfo(i,r,a,e,l),l.str_count=a.str_count,l.show_class=e.show_class,l.attr_name=e.name,n.toolbox.feature.myShowDetailData.onclick=function(){return dmtShowChartDetailInfo(i,o,e.id)},g_all_charts[t]=echarts.init(document.getElementById(t),g_dmtChartStyle),g_all_charts[t].setOption(n),g_all_charts[t].warnInfo=l,g_all_charts[t].setwidth=g_dmtChartWidth}function dmtGetXAxisTimeInfo(t,e,a,r){for(var i=[],n=0;n<a.static_idx_max*e&&!("number"==typeof r&&r<=n);n++)i.push(t+n*a.static_time*60*1e3);return i}function dmtGetXAxisDayTimeInfo(t,e){for(var a=[],r=0;r<e;r++)a.push(t+24*r*60*60*1e3);return a}function dmtGetYAxisDayAddData(t,e,a,r){var i=[],n=a.split(",");if(t.length<=0||n.length<=0)return i;for(var o=0,l=0,s=0;s<e.static_idx_max&&s<n.length;s++)if("-"!=n[s]&&!isNaN(n[s])){l=Number(n[s]);break}for(var _=l,d=e.static_idx_max-1;s<d&&d<n.length;d--)if("-"!=n[d]&&!isNaN(n[d])){_=Number(n[d]);break}if((g=new Object).value=new Array(t[0],_-l),i.push(g),t.length<=1)return i;for(var c=_,m=0,u=1;u<t.length-1;u++){_=c;for(m=(u+1)*e.static_idx_max-1,d=e.static_idx_max;0<d&&0<=m&&m<n.length;d--,m--)if("-"!=n[m]&&!isNaN(n[m])){_=Number(n[m]);break}var h=0;0!=_&&_!=c&&(0==o&&0==c?o=1:h=_-c,c=_),(g=new Object).value=new Array(t[u],h),i.push(g)}var g,h=0,p=(t.length-1)*e.static_idx_max;if((2==e.data_type||4==e.data_type||5==e.data_type||8==e.data_type)&&0!=r&&e.length>p)c!=r&&(h=r-c);else if(n.length>=p){for(m=n.length-1;p<=m;m--)if("-"!=n[m]&&!isNaN(n[m])){_=Number(n[m]);break}0!=_&&_!=c&&(0==o&&0==c||(h=_-c))}return(g=new Object).value=new Array(t[u],h),i.push(g),i}function dmtGetStartXAxis(t,e){return 0!=t.length&&t.length>=e?100-dmtMathtrunc(100*e/t.length):0}function dmtGetYAxisData(t,e,a,r){if("0"==e)return[];for(var i,n=[],o=e.split(","),l=0;l<o.length&&!("number"==typeof r&&r<=l);l++){void 0===a&&("-"==o[l]||isNaN(o[l]))||(i=new Object,isNaN(o[l])?i.value=new Array(t[l],0):i.value=new Array(t[l],o[l]),n.push(i))}return n}function dmtGetUsePerPieOption(t){var e=$.extend({c_items:1,c_sublink:""},t);4<e.c_colors.length&&e.c_colors[4],e.c_items;var a={backgroundColor:"transparent",title:{id:e.c_name,text:e.c_text,triggerEvent:!0,subtext:e.c_subtext,left:"center",top:"center",textStyle:{fontSize:14,fontFamily:"PingFangSC-Regular"},subtextStyle:{fontSize:1<e.c_items?14:18,fontFamily:"PingFangSC-Regular",fontWeight:"bold",top:"center"},itemGap:-1},series:[{name:e.c_name,type:"pie",clockWise:!0,radius:["80%","95%"],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},hoverAnimation:!1,data:[{value:e.c_val,name:"completed",itemStyle:{normal:{borderWidth:8,borderColor:{colorStops:[{offset:0,color:e.c_colors[0]||e.c_colors[1]},{offset:1,color:e.c_colors[2]||e.c_colors[3]}]},color:{colorStops:[{offset:0,color:e.c_colors[0]||e.c_colors[1]},{offset:1,color:e.c_colors[2]||e.c_colors[3]}]},label:{show:!1},labelLine:{show:!1}}}},{name:"gap",value:100-e.c_val,itemStyle:{normal:{label:{show:!1},labelLine:{show:!1},color:"rgba(0, 0, 0, 0)",borderColor:"rgba(0, 0, 0, 0)",borderWidth:0}}}]}]};return""!=e.c_sublink&&(a.title.sublink=e.c_sublink,a.title.subtarget="self"),a}function dmtShowPluginAttrInfo(t,e){var a={backgroundColor:"transparent",legend:{show:!1,bottom:10},title:{text:"",x:"left",left:10,subtext:"",top:5,subtextStyle:{fontSize:12,color:"red"},textStyle:{fontSize:14},show:!0},useUTC:!0,toolbox:{show:!0,orient:"horizontal",top:"top",zlevel:999,right:5,feature:{restore:{show:!0,title:"还原图表显示"},dataZoom:{show:!0,xAxisIndex:0,yAxisIndex:!1},saveAsImage:{show:!1}}},tooltip:{formatter:null,trigger:"axis"},grid:{backgroundColor:"transparent",tooltip:{show:!0,trigger:"axis"},show:!1,top:50,left:60,right:30,bottom:50},xAxis:{show:!0,type:"time",splitLine:{show:!1},axisPointer:{label:{formatter:function(t){return"上报时间："+dmtGetDateStr(t.value,!0)}}}},yAxis:{splitLine:{show:!1},splitArea:{show:!1},axisLabel:{formatter:null},show:!0,type:"value"},dataZoom:[{type:"inside",xAxisIndex:0}],series:[{name:"",showSymbol:!1,cursor:"pointer",smooth:!0,smoothMonotone:"x",type:"line",itemStyle:{normal:{color:"#009895"},lineStyle:{normal:{color:"#009895",opacity:1}}},sampling:"average",areaStyle:null,stack:null,data:[]},{name:"",showSymbol:!1,cursor:"pointer",smooth:!0,smoothMonotone:"x",type:"line",itemStyle:{normal:{color:"#F3891B"},lineStyle:{normal:{color:"#F3891B",opacity:1}}},sampling:"average",areaStyle:null,stack:null,data:[]},{name:"",showSymbol:!1,cursor:"pointer",smooth:!0,smoothMonotone:"x",type:"line",itemStyle:{normal:{color:"#006AD4"},lineStyle:{normal:{color:"#F3891B",opacity:1}}},sampling:"average",areaStyle:null,stack:null,data:[]}]};if(!(void 0===t.value_list_str||"undefined"==t.attr_list||t.attr_list.count<=0)){var r=1e3*t.date_time_start_utc-60*(new Date).getTimezoneOffset()*1e3,i=1;3==t.type&&(i=7);var n=t.attr_list.list[0],o=dmtGetXAxisTimeInfo(r,i,n,t.max_x);0!=t.max&&(1==t.type?a.series[0].data=dmtGetYAxisData(o,t.value_list_str,!0,t.max_x):a.series[0].data=dmtGetYAxisData(o,t.value_list_str),1==t.type&&(a.series[0].name="今日 ["+t.date_time_cur+"]",a.series[1].name="昨日 ["+t.date_time_yst+"]",a.series[1].data=dmtGetYAxisData(o,t.value_list_yst_str,!0,t.max_x),a.series[2].name="上周同日 ["+t.date_time_wkd+"]",a.series[2].data=dmtGetYAxisData(o,t.value_list_lwk_str,!0,t.max_x),a.legend={show:!0,bottom:10},a.grid.bottom=80),d="attr_0_"+t.id+"pluginattr",0<$("#"+d).length&&$("#"+d).html(""),c='<div style="width:'+g_dmtChartWidth+"px; ",c+=" height:"+g_dmtChartHeight+"px; ",c+=" float:left; margin:"+g_dmtChartMargin+'px;" ',c+=' type="pluginattr" ',c+=' id="'+d+'" ',c+=' class="chart-DES-PWE" ',c+=' type_id="'+t.id+'" >',c+="</div>",$(e).append($(c)),void 0!==g_all_charts[d]&&g_all_charts[d].dispose(),a.title.text=" 汇总图 - "+n.name,g_all_charts[d]=echarts.init(document.getElementById(d),g_dmtChartStyle),dmtSetChartOptionByAttrInfo(n,a,{day_type:t.type}),g_all_charts[d].setOption(a));for(var l=!0,s=t.each_mach.list,_=0;_<s.length;_++){var d="attr_"+s[_].id+"_"+t.id+"pluginattr";0<$("#"+d).length&&(dmtJsBugReport("dmt.comm.js","dmtShowPluginAttrInfo","bug:"+d),$("#"+d).html(""));var c='<div style="width:'+g_dmtChartWidth+"px; ";c+=" height:"+g_dmtChartHeight+"px; ",c+=" float:left; margin:"+g_dmtChartMargin+'px;" ',c+=' type="pluginattr" ',c+=' id="'+d+'" ',c+=' class="chart-DES-PWE" ',c+=' type_id="'+t.id+'" >',c+="</div>",$(e).append($(c)),void 0!==g_all_charts[d]&&g_all_charts[d].dispose();var m,o=dmtGetXAxisTimeInfo(r,i,n),l=void 0!==s[_].value_list_str&&0<s[_].max?(1==t.type?a.series[0].data=dmtGetYAxisData(o,s[_].value_list_str,!0,t.max_x):a.series[0].data=dmtGetYAxisData(o,s[_].value_list_str),!0):!(a.series[0].data=[]);1==t.type&&(a.series[0].name="今日 ["+t.date_time_cur+"]",void 0!==t.each_mach_yst.list[_].value_list_str?a.series[1].data=dmtGetYAxisData(o,t.each_mach_yst.list[_].value_list_str,!0,t.max_x):a.series[1].data=[],a.series[1].name="昨日 ["+t.date_time_yst+"]",void 0!==t.each_mach_lwk.list[_].value_list_str?a.series[2].data=dmtGetYAxisData(o,t.each_mach_lwk.list[_].value_list_str,!0,t.max_x):a.series[2].data=[],a.series[2].name="上周同日 ["+t.date_time_wkd+"]","0"==t.each_mach_yst.list[_].value_list_str&&"0"==t.each_mach_lwk.list[_].value_list_str||(l=!0)),5==n.data_type?a.yAxis.min=s[_].min:a.yAxis.min=0,s[_].name!=s[_].ip1?a.title.text="上报机器【"+s[_].id+"】"+s[_].name+"("+s[_].ip1+")":a.title.text="上报机器【"+s[_].id+"】"+s[_].name,l?(a.title.textStyle.fontSize=14,a.title.link="",a.title.subtextStyle.fontSize=12,a.title.subtext="",a.title.top=5,a.title.left=10,a.xAxis.show=!0,a.yAxis.show=!0,a.toolbox.feature.dataZoom.show=!0):(a.title.textStyle.fontSize=16,a.title.subtextStyle.fontSize=14,0<s[_].cur?(m=" 当前时间："+attr_val_list.date_time+", ",m+=" 当前统计周期已上报："+dmtShowChangeValue(s[_].cur)+", ",m+=" 统计周期："+dmtShowHumanStaticTime(n.static_time)+"\n\n",a.title.subtext=m):a.title.subtext="暂无数据上报",a.title.link="",a.title.top="center",a.title.left="center",a.xAxis.show=!1,a.yAxis.show=!1,a.toolbox.feature.dataZoom.show=!1),g_all_charts[d]=echarts.init(document.getElementById(d),g_dmtChartStyle),dmtSetChartOptionByAttrInfo(n,a,{day_type:t.type}),g_all_charts[d].setOption(a),g_all_charts[d].setwidth=g_dmtChartWidth}}}function dmtShowAttrLineAndPie(i,t,e,a,r){var n=$.extend({stack:"line_pie_"+i.id,showAllSymbol:"auto",symbol:"emptyCircle",cursor:"pointer",smoothMonotone:"x",smooth:!0,type:"line",sampling:"average"},a),o=$.extend({type:"pie",id:"line_pie_id",radius:"30%",top:5,center:["38%","30%"],data:[],tooltip:{show:!0,confine:!0,trigger:"item",formatter:"{b}: {c}"}},r),l=$.extend({backgroundColor:"transparent",legend:{show:!0,orient:"orient",top:30,right:10},tooltip:{formatter:function(t,e,a){for(var r=t[0].axisValueLabel,i=0;i<t.length;i++)r+="<br />"+t[i].seriesName+": "+t[i].value[1]+"%";return r},trigger:"axis"},title:{text:i.title,subtext:"",x:"left",left:10,top:5,subtextStyle:{fontSize:12},textStyle:{fontSize:14},show:!0},useUTC:!0,grid:{backgroundColor:"transparent",tooltip:{show:!0,trigger:"axis"},show:!1,top:"55%",left:60,right:30,bottom:50},xAxis:{show:!0,type:"time",splitLine:{show:!1},gridIndex:0,axisPointer:{label:{formatter:function(t){return"时间："+dmtGetDateStr(t.value,!0)}}}},color:g_dmtChartColor,yAxis:{splitLine:{show:!1},splitArea:{show:!1},axisLabel:{formatter:"{value}%"},type:"value",gridIndex:0},dataZoom:[{type:"inside",start:0,end:100,xAxisIndex:0}],series:[]},e);if(!(void 0===i.attr_val_list||"undefined"==i.attr_list||i.attr_list.length<=0)){var s=1e3*i.date_time_start_utc-60*(new Date).getTimezoneOffset()*1e3,_=i.attr_list[0],d=1;"number"==typeof i.day_count&&(d=i.day_count);var c=dmtGetXAxisTimeInfo(s,d,_,i.attr_val_list[0].max_x),m="line_pie_attr_"+i.attr_val_list[0].id+"_"+i.id+i.showtype;0<$("#"+m).length&&(dmtJsBugReport("dmt.comm.js","dmtShowAttrLineAndPie","bug:"+m),$("#"+m).html(""));var u=3*g_dmtChartHeight/2;"number"==typeof i.chartHeight&&(u=i.chartHeight);var h='<div style="width:'+g_dmtChartWidth+"px; ";h+=" height:"+u+"px; ",h+=" float:left; margin:"+g_dmtChartMargin+'px;" ',h+=' type="pluginattr" ',h+=' id="'+m+'" ',h+=' class="chart-DES-PWE" ',h+=' type_id="'+i.id+'" >',h+="</div>",$(t).prepend($(h)),void 0!==g_all_charts[m]&&g_all_charts[m].dispose();for(var g=0,p=0;p<i.attr_val_list.length;p++)l.series.push(dmtCloneObj(n)),l.series[p].name=i.attr_list[p].c_short_name,l.series[p].data=dmtGetYAxisData(c,i.attr_val_list[p].value_list_str,!0),i.attr_val_list[p].max_x>g&&(g=i.attr_val_list[p].max_x);var f=30;if("number"==typeof i.show_count_statics&&(f=i.show_count_statics),0!=g&&(l.dataZoom[0].start=dmtMathtrunc(100-100*f/g),l.dataZoom[0].start<0&&(l.dataZoom[0].start=0)),"number"==typeof i.total_value&&"string"==typeof i.other_value_name&&i.draw_other_line){for(var w=[],x=0;x<l.series[0].data.length;x++){for(var y=new Object,v=0,p=0;p<l.series.length;p++)v+=Number(l.series[p].data[x].value[1]);0<i.total_value-v?y.value=new Array(l.series[0].data[x].value[0],i.total_value-v):y.value=new Array(l.series[0].data[x].value[0],0),w.push(y)}l.series.push(dmtCloneObj(n)),l.series[p].name=i.other_value_name,l.series[p].data=w}l.series.push(o);var b="{b}：{d}%";void 0!==i.is_value_percent&&i.is_value_percent&&(b="{b}：{c}%"),g_all_charts[m]=echarts.init(document.getElementById(m),g_dmtChartStyle),g_all_charts[m].setOption(l),g_all_charts[m].setwidth=g_dmtChartWidth;function Qe(t){for(var e=[],a=0,r=0;r<l.series.length-1;r++)0<Number(l.series[r].data[t].value[1])&&(e.push({name:l.series[r].name,value:l.series[r].data[t].value[1]}),a+=Number(l.series[r].data[t].value[1]));"number"!=typeof i.total_value||"string"!=typeof i.other_value_name||i.draw_other_line||0<i.total_value-a&&e.push({name:i.other_value_name,value:i.total_value-a}),g_all_charts[m].setOption({title:{subtext:"时间："+dmtGetDateStr(l.series[0].data[t].value[0])},series:{id:"line_pie_id",label:{show:!0,formatter:b},data:e}})}Qe(l.series[0].data.length-1),g_all_charts[m].on("updateAxisPointer",function(t){"number"==typeof t.dataIndex&&Qe(t.dataIndex)})}}function dmtCloneObj(t){var e={};for(var a in t instanceof Array&&(e=[]),t)"Object"==typeof a&&cloneObj(a),e[a]=t[a];return e}function dmtShowAttr2Line(t,e,a,r,i){var n=$.extend({stack:"",showAllSymbol:"auto",symbol:"emptyCircle",cursor:"pointer",smoothMonotone:"x",smooth:!0,type:"line",xAxisIndex:0,yAxisIndex:0,sampling:"average"},r),o=$.extend({stack:"two_line_2_"+t.id,showAllSymbol:"auto",symbol:"emptyCircle",cursor:"pointer",smoothMonotone:"x",smooth:!0,xAxisIndex:1,yAxisIndex:1,areaStyle:{},type:"line",sampling:"average"},i),l=$.extend({backgroundColor:"transparent",legend:{show:!0,orient:"horizontal",top:"50%",left:10},tooltip:{trigger:"axis"},title:[{text:t.title_1,subtext:"",x:"left",left:10,top:5,subtextStyle:{fontSize:12},textStyle:{fontSize:14},show:!0},{text:t.title_2,subtext:"",right:30,top:"55%",subtextStyle:{fontSize:12},textStyle:{fontSize:14},show:!1}],useUTC:!0,grid:[{backgroundColor:"transparent",tooltip:{show:!0,trigger:"axis"},bottom:"58%",left:60,right:25},{backgroundColor:"transparent",tooltip:{show:!0,trigger:"axis"},top:"62%",height:"30%",left:60,right:25}],xAxis:[{show:!0,type:"time",splitLine:{show:!1},gridIndex:0,axisPointer:{label:{formatter:function(t){return"时间："+dmtGetDateStr(t.value,!0)}}}},{show:!0,type:"time",splitLine:{show:!1},gridIndex:1,axisPointer:{label:{formatter:function(t){return"时间："+dmtGetDateStr(t.value,!0)}}}}],color:g_dmtChartColor,yAxis:[{splitLine:{show:!1},splitArea:{show:!1},axisLabel:{formatter:function(t,e){return dmtGetHumanReadFixed2(t)}},gridIndex:0,type:"value"},{splitLine:{show:!1},splitArea:{show:!1},axisLabel:{formatter:function(t,e){return dmtGetHumanReadFixed2(t)}},type:"value",gridIndex:1}],dataZoom:[{type:"inside",start:0,end:100,xAxisIndex:0},{type:"inside",start:0,end:100,xAxisIndex:1}],series:[]},a);if(!(t.attr_list_1.length<=0&&t.attr_list_2.length<=0)){var s=1e3*t.date_time_start_utc-60*(new Date).getTimezoneOffset()*1e3,_=null,_=(t.attr_list_1.length,t.attr_list_1[0]),d=1;"number"==typeof t.day_count&&(d=t.day_count);var c=0,m=dmtGetXAxisTimeInfo(s,d,_,c=0<t.attr_val_list_1.length?t.attr_val_list_1[0].max_x:t.attr_val_list_2[0].max_x),u="line2_attr_"+_.id+"_"+t.id+t.showtype;0<$("#"+u).length&&(dmtJsBugReport("dmt.comm.js","dmtShowAttrLineAndPie","bug:"+u),$("#"+u).html(""));var h=3*g_dmtChartHeight/2;"number"==typeof t.chartHeight&&(h=t.chartHeight);var g='<div style="width:'+g_dmtChartWidth+"px; ";g+=" height:"+h+"px; ",g+=" float:left; margin:"+g_dmtChartMargin+'px;" ',g+=' type="pluginattr" ',g+=' id="'+u+'" ',g+=' class="chart-DES-PWE" ',g+=' type_id="'+t.id+'" >',g+="</div>",$(e).prepend($(g)),void 0!==g_all_charts[u]&&g_all_charts[u].dispose(),l.title[0].subtext="日期："+t.date_time_cur;for(var p=0,p=c=0;p<t.attr_val_list_1.length;p++)l.series.push(dmtCloneObj(n)),l.series[p].name=t.attr_list_1[p].name,l.series[p].data=dmtGetYAxisData(m,t.attr_val_list_1[p].value_list_str,!0),t.attr_val_list_1[p].max_x>c&&(c=t.attr_val_list_1[p].max_x);var f=30;"number"==typeof t.show_count_statics&&(f=t.show_count_statics),0!=c&&(l.dataZoom[0].start=dmtMathtrunc(100-100*f/c),l.dataZoom[0].start<0&&(l.dataZoom[0].start=0));for(var w=c=0;w<t.attr_val_list_2.length;w++,p++)l.series.push(dmtCloneObj(o)),l.series[p].name=t.attr_list_2[w].name,l.series[p].data=dmtGetYAxisData(m,t.attr_val_list_2[w].value_list_str,!0),t.attr_val_list_2[w].max_x>c&&(c=t.attr_val_list_2[w].max_x);f=30;"number"==typeof t.show_count_statics&&(f=t.show_count_statics),0!=c&&(l.dataZoom[1].start=dmtMathtrunc(100-100*f/c),l.dataZoom[1].start<0&&(l.dataZoom[1].start=0)),g_all_charts[u]=echarts.init(document.getElementById(u),g_dmtChartStyle),g_all_charts[u].setOption(l),g_all_charts[u].setwidth=g_dmtChartWidth}}function dmtSetTreeChartData(t){switch(t.xrk_type){case 1:t.symbol="image://"+g_siteInfo.doc_path+"images/xrk_server.png",t.symbolSize=[35,40];break;case 2:t.symbol="image://"+g_siteInfo.doc_path+"images/xrk_conn.png",t.symbolSize=[30,25],t.label={fontWeight:"bold",distance:10},t.name+="\n "+t.xrk_ip_geo;break;case 3:t.symbol="image://"+g_siteInfo.doc_path+"images/xrk_gw_conn.png",t.symbolSize=[30,25];break;case 4:t.symbol="image://"+g_siteInfo.doc_path+"images/xrk_gw.png",t.symbolSize=[30,25];break;default:t.symbol="image://"+g_siteInfo.doc_path+"images/clt_server.png",t.symbolSize=[20,25],3==t.xrk_req_status||1==t.xrk_req_status?(t.label={color:"red",fontWeight:"bold",distance:8},t.name=t.name+"\n 无心跳"):(2==t.xrk_req_status?t.label={color:"blue",fontWeight:"bold",distance:8}:t.label={color:"white",fontWeight:"bold",distance:8},t.name+="\n "+t.xrk_response_ms+"ms / "+t.xrk_jumps+" 跳")}if(void 0!==t.children)for(var e=0;e<t.children.length;e++)dmtSetTreeChartData(t.children[e])}function dmtGetMachineReqStatus(t){switch(t){case 3:return'<span class="xrk_show_txt_hs">长时间离线</span>';case 2:return'<span class="xrk_text_bl">数据上报中</span>';case 1:return'<span class="xrk_show_txt_hs">无心跳</span>';case 0:return'<span class="xrk_text_bl2">心跳正常</span>';default:return'<span color="xrk_show_txt_hs">未知状态:'+t+"</span>"}}function dmtGetTopData(t,e,a){for(var r=0,r=0;r<t.length;r++)"null"==t[r].x?t[r].x=null:t[r].x=t[r].x*e/100,"null"==t[r].y?t[r].y=null:t[r].y=t[r].y*a/100,"null"==t[r].itemStyle&&(t[r].itemStyle=null);return t}function dmtShowTreeChart(t,e){var a={backgroundColor:"transparent",tooltip:{show:!0,formatter:function(t){var e="",a=t.name;switch(-1!=t.name.indexOf("\n")&&(a=t.name.substring(0,t.name.indexOf("\n"))),t.data.xrk_type){case 1:e+="云框架系统服务端<br />";break;case 2:e+="接入服务器<br />接入地址："+a,e+="<br />IP 归属地："+t.data.xrk_ip_geo,e+="<br />运营商："+t.data.xrk_ip_owner;break;case 3:e+="中间路由器群...";break;case 4:e+="节点网关<br />网关地址："+a+"<br />节点数："+t.data.children.length,e+="<br />IP 归属地："+t.data.xrk_ip_geo,e+="<br />运营商："+t.data.xrk_ip_owner;break;case 5:e+="监控节点<br />机器IP："+a+"<br />节点状态："+dmtGetMachineReqStatus(t.data.xrk_req_status),0!=t.data.xrk_req_status&&2!=t.data.xrk_req_status||(e+="<br />响应耗时："+t.data.xrk_response_ms+"ms"),e+="<br />路由跳数："+t.data.xrk_jumps;break;default:e+="未知类型<br />"}return e}},title:{x:"center",top:"20",text:"云框架系统实时网络拓扑"},series:[{type:"tree",top:"65",left:"5%",bottom:"5%",right:"70",roam:!0,backgroundColor:"transparent",layout:"orthogonal",expandAndCollapse:!0,symbol:"image://"+g_siteInfo.doc_path+"images/clt_server.png",symbolSize:[25,25],data:[],orient:"LR",label:{color:"#fff",position:"top",verticalAlign:"middle",align:"middle"},leaves:{label:{position:"top",verticalAlign:"middle",align:"middle"}},expandAndCollapse:!0,initialTreeDepth:-1,animation:!0,animationDuration:0}]},r=echarts.init(document.getElementById(e),g_dmtChartStyle);return dmtSetTreeChartData(t),a.series[0].data[0]=t,r.setOption(a),r}function dmtShowGraphChart(t,e,a){var r={backgroundColor:"transparent",title:{x:"center",top:25,textStyle:{fontSize:14},show:!1,text:"云框架系统实时网络拓扑图"},legend:[{type:"scroll",orient:"horizontal",left:"left",top:"40",show:!0}],animation:!0,series:[{type:"graph",layout:"circular",backgroundColor:"transparent",edgeLabel:{fontSize:20},symbolSize:30,data:[],links:[],label:{show:!0},roam:!0,circular:{rotateLabel:!1},force:{initLayout:"circular",edgeLength:200,repulsion:100,layoutAnimation:!0,draggable:!1,focusNodeAdjacency:!0,symbolRotate:70}}]};void 0!==a&&null!=a&&a.dispose(),a=echarts.init(document.getElementById(e),g_dmtChartStyle),r.series[0].data=dmtGetTopData(t.data,$("#"+e).width(),$("#"+e).height()),r.series[0].links=t.links,a.setOption(r)}function dmtShowAttrInfo(t,e,a,r){var i,n={name:"",symbol:"emptyCircle",showSymbol:!1,cursor:"pointer",smooth:!0,smoothMonotone:"x",type:"line",itemStyle:{normal:{},lineStyle:{normal:{opacity:1}}},sampling:"average",areaStyle:null,stack:null,data:[]},o={backgroundColor:"transparent",legend:{show:!1,bottom:10},title:{text:"",x:"left",subtext:"",top:5,subtextStyle:{fontSize:12,color:"red"},textStyle:{fontSize:14},show:!0},useUTC:!0,toolbox:{show:!0,orient:"horizontal",top:"top",zlevel:999,right:5,feature:{myPluginShowAttrMach:{show:!1,title:"查看该监控点在各机器的上报",icon:"image://"+g_siteInfo.doc_path+"images/application_view_tile.png",onclick:function(){}},myUnMaskWarningData:{show:!0,title:"取消屏蔽提示",icon:"image://"+g_siteInfo.doc_path+"images/phone_sound.png",onclick:function(){}},myMaskWarningData:{show:!0,title:"屏蔽提示",icon:"image://"+g_siteInfo.doc_path+"images/phone_delete.png",onclick:function(){}},mySetWarningData:{show:!0,title:"设置提示",icon:"image://"+g_siteInfo.doc_path+"images/phone_edit.png",onclick:function(){}},myShowSingleData:{show:!0,title:"单独显示图表数据",icon:"image://"+g_siteInfo.doc_path+"images/arrow_out_longer.png",onclick:function(){}},myShowDetailData:{show:!0,title:"图表概要信息",icon:"image://"+g_siteInfo.doc_path+"images/database_table.png",onclick:function(){}},restore:{show:!0,title:"还原图表显示"},dataZoom:{show:!0,xAxisIndex:0,yAxisIndex:!1},saveAsImage:{show:!1}}},tooltip:{trigger:"none",axisPointer:{type:"cross",snap:!0}},color:g_dmtChartColor,grid:{backgroundColor:"transparent",tooltip:{show:!0,trigger:"axis"},show:!1,top:50,left:60,right:30,bottom:50},xAxis:{show:!0,type:"time",splitLine:{show:!1},axisPointer:{label:{formatter:function(t){return 1!=e.type?dmtGetDateStr(t.value):dmtGetDateStr(t.value,!0)}}}},yAxis:{splitLine:{show:!1},splitArea:{show:!1},axisLabel:{formatter:null},show:!0,type:"value"},dataZoom:[{type:"inside",start:0,end:100,xAxisIndex:0}],series:[]},l=e.list;if(void 0!==l){"view"==r?i=e.view_id:"machine"==r?i=e.machine_id:"pluginview"==r&&(i=e.plugin_id);var s=1e3*e.date_time_start_utc-60*(new Date).getTimezoneOffset()*1e3,_=1;void 0!==e.date_time_monday&&(_=7),1==e.type&&(o.legend.show=!0,o.grid.bottom=80);for(var d=!0,c=0;c<l.length;c++){var m="attr_"+l[c].id+"_"+i+r;0<$("#"+m).length&&(dmtJsBugReport("dmt.comm.js","dmtShowAttrInfo","bug:"+m),$("#"+m).html(""));var u='<div style="width:'+g_dmtChartWidth+"px; ";u+=" height:"+g_dmtChartHeight+"px; ",u+=" float:left; margin:"+g_dmtChartMargin+'px;" ',u+=' type="'+r+'" ',u+=' id="'+m+'" ',u+=' class="chart-DES-PWE" ',u+=' type_id="'+i+'" >',u+="</div>",$(a).append($(u));var h=t.list[c];h.id!=l[c].id&&(h=dmtGetAttrInfo(t,l[c].id)),void 0!==g_all_charts[m]&&g_all_charts[m].dispose();var g,p,f=dmtGetXAxisTimeInfo(s,_,h,l[c].max_x);h.data_type!=STR_REPORT_D_IP?h.data_type!=STR_REPORT_D?(o.series.push(dmtCloneObj(n)),void 0!==l[c].value_list_str&&0<l[c].max?(1==e.type?o.series[0].data=dmtGetYAxisData(f,l[c].value_list_str,!0,l[c].max_x):o.series[0].data=dmtGetYAxisData(f,l[c].value_list_str),d=!0,e.is_today&&0<l[c].max_x?(o.dataZoom[0].start=dmtGetStartXAxis(o.series[0].data,30),o.dataZoom[0].start<0&&(o.dataZoom[0].start=0),o.series[0].showSymbol=!0):o.dataZoom[0].start=0):d=!(o.series[0].data=[]),1==e.type&&(o.series.push(dmtCloneObj(n)),o.series.push(dmtCloneObj(n)),o.series[0].name="今日 ["+e.date_time_cur+"]","0"!=l[c].value_list_yst_str?o.series[1].data=dmtGetYAxisData(f,l[c].value_list_yst_str,!0,l[c].max_x):o.series[1].data=[],o.series[1].name="昨日 ["+e.date_time_yst+"]","0"!=l[c].value_list_lwk_str?o.series[2].data=dmtGetYAxisData(f,l[c].value_list_lwk_str,!0,l[c].max_x):o.series[2].data=[],o.series[2].name="上周同日 ["+e.date_time_wkd+"]","0"==l[c].value_list_yst_str&&"0"==l[c].value_list_lwk_str||(d=!0)),h.data_type==SUM_REPORT_TOTAL?o.yAxis.min=l[c].min:o.yAxis.min=0,e.show_single_type=e.type,o.title.text=h.name+"【"+h.id+"】",g=new Object,dmtSetViewChartInfo(r,e,l[c],h,g),dmtSetCustToolBox(o,r,e,l[c],h,g),d?(o.title.textStyle.fontSize=14,o.title.subtextStyle.fontSize=12,o.title.subtext="",o.title.top=5,o.title.left=10,o.xAxis.show=!0,o.yAxis.show=!0,o.toolbox.feature.dataZoom.show=!0,o.toolbox.feature.myShowSingleData.show="pluginview"!=r):(o.title.textStyle.fontSize=16,o.title.subtextStyle.fontSize=14,0<l[c].cur?(p="\n\n 当前时间："+e.date_time+", ",p+=" 当前统计周期已上报："+dmtShowChangeValue(l[c].cur)+", ",p+=" 统计周期："+dmtShowHumanStaticTime(h.static_time)+"\n\n",o.title.subtext=p):o.title.subtext="\n\n暂无数据上报",o.title.top="40%",o.title.left="center",o.xAxis.show=!1,o.yAxis.show=!1,o.toolbox.feature.dataZoom.show=!1,o.toolbox.feature.myShowSingleData.show=!1),g_all_charts[m]=echarts.init(document.getElementById(m),g_dmtChartStyle),dmtSetChartOptionByAttrInfo(h,o,{showtype:r,day_type:e.type}),g_all_charts[m].setOption(o),g_all_charts[m].warnInfo=g,g_all_charts[m].setwidth=g_dmtChartWidth):dmtSetStrAttrInfoChart(m,h,l[c],e,r):dmtSetStrAttrInfoChartIpGeo(m,h,l[c],e,r)}}}function dmtChartContainerEmpty(t){$(t).css("padding-top","20px").html('<font color="red" style="font-size:16px;font-weight:bold;">无监控点或监控点暂无数据上报</font>')}function dmtGetSyssetTypeHtml(t){var e="<label>服务器类型：</label>";return e+='<select name="',e+=t+'" id="',e+=t+'">" ',e+='<option value="0">请选择</option>',e+='<option value="1">日志服务器</option>',e+='<option value="2">监控点服务器</option>',e+='<option value="3">mysql 监控点服务器</option>',e+='<option value="4">中心服务器</option>',e+='<option value="11">web 服务器</option>',g_html_systype=e+="</select>",g_html_systype}function dmtGetServerTypeName(t){switch(t){case 1:return"日志服务器";case 2:return"监控点服务器";case 3:return"mysql 监控点服务器";case 4:return"中心服务器";case 11:return"web 服务器";default:return"未知类型"}}function dmtTriggerLeftMenu(){1!=DWZ.ui.sbar?0!=DWZ.ui.sbar||$("#sidebar_s .toggleCollapse div").trigger("click"):$("#sidebar .toggleCollapse div").trigger("click")}function dmtLv2CheckCodeDlgClose(){return"undefined"!=typeof g_dclc_TimerId&&null!=g_dclc_TimerId&&(clearTimeout(g_dclc_TimerId),g_dclc_TimerId=null),!0}function dmtPopDaemonTipMsg(){void 0!==$.pdialog._current&&null!=$.pdialog._current&&$.pdialog.closeCurrent();$.pdialog.openLocal("dct_dlg_show_daemon_tip_msg","dct_dlg_show_daemon_tip_msg","演示版操作提示",{mask:!0,maxable:!1,height:280,width:410,resizable:!1,drawable:!0})}function dmtFirstDealAjaxResponse(t){if(void 0===t)return!1;if(null==t||"null"==t||void 0===t.ec)return!1;if(666==t.ec)return dmtPopDaemonTipMsg(),!0;if(111==t.ec)return navTab.closeCurrentTab(),void 0!==$.pdialog._current&&null!=$.pdialog._current&&$.pdialog.closeCurrent(),location=t.redirect_url,!0;if(300==t.ec||1<=t.ec&&t.ec<200){var e="服务器返回错误，错误码：";return e+=t.ec,void 0!==t.msg?(e+="，错误消息：",e+=t.msg):void 0!==t.msgid&&(e+="，错误消息：",e+=DWZ.msg(json.msgid)),alertMsg.warn(e),!0}return!1}function dmtGetHumanReadFixed2ByKB(t){return dmtGetHumanReadFixed2(1024*t)}function dmtGetHumanReadFixed2(t){return 1073741824<=t?(t/1073741824).toFixed(2)+"G":1048576<=t?(t/1048576).toFixed(2)+"M":1024<=t?(t/1024).toFixed(2)+"K":t}function dmtGetHumanReadDigitByKB(t){var e,a="";return 1048576<=t?(e=t/1048576,a=Math.round(100*parseFloat(e))/100+" GB"):1024<=t?(e=t/1024,a=Math.round(100*parseFloat(e))/100+" MB"):void 0!==t&&(a=t+" KB"),a}function dmt_duc_dlg_modify_name_close(){return"undefined"!=typeof g_dci_TimerId&&null!=g_dci_TimerId&&(clearTimeout(g_dci_TimerId),g_dci_TimerId=null),!0}function dmtGetFastWebIdx(){if("undefined"==typeof r_siteInfo)return 0;r_siteInfo.web_fast_ms=864e5,r_siteInfo.web_slow_ms=0;for(var t,e=r_siteInfo.web_list,a=e.length,r=0;r<e.length;r++){void 0!==e[r].end&&((t=e[r].end.getTime()-e[r].start.getTime())>r_siteInfo.web_slow_ms&&(r_siteInfo.web_slow_ms=t),t<r_siteInfo.web_fast_ms&&(r_siteInfo.web_fast_ms=t,a=r))}return a}function dmtTestWebSvr(){if("undefined"==typeof r_siteInfo)return 0;for(var t=0;t<r_siteInfo.web_list.length;t++){r_siteInfo.web_list[t].start=new Date;var e="http://"+r_siteInfo.web_list[t].ip+"/cgi-bin/slog_flogin?action=check_web_speed";e+="&check_idx="+t,$.ajax({url:e,cache:!1,success:function(t){0<=t.check_idx&&t.check_idx<r_siteInfo.web_list.length&&(r_siteInfo.web_list[t.check_idx].end=new Date)},dataType:"json"})}}function dmtGetBytesLength(t){for(var e=0,a=0,r=t.length;a<r;a++)charCode=t.charCodeAt(a),charCode<=127?e+=1:charCode<=2047?e+=2:charCode<=65535?e+=3:e+=4;return e}function redrawChartsOnSwitchTab(){var t,e,a,r=navTab.getCurrentTabId();if(null!=r){if(r.match("showmachine_"))e="machine",t=r.split("_")[1],a="none"!=$("#dsmLeftMenu_"+t).css("display");else if(r.match("showplugin_"))e="plugin",t=r.split("_")[1],a=!1;else if(r.match("showview_"))e="view",t=r.split("_")[1],a="none"!=$("#dsLeftMenu_"+t).css("display");else if(r.match("pluginview_"))e="pluginview",t=r.split("_")[1],a="none"!=$("#dsPluginLeftMenu_"+t).css("display");else{if(!r.match("pluginattr_"))return;e="pluginattr",t=r.split("_")[1],a="none"!=$("#ditsPluginLeftMenu_"+t).css("display")}dmtSetRedrawChartsInfo(t,e,a),dmtRedrawCharts()}}function redrawChartsMain(){$("#navMenuLast").hasClass("selected")&&(dcMainPageSetChartSize(),dcMainPageRedrawChart())}function redrawCharts(){var t=navTab.getCurrentTabId();null!=t?((t.match("showmachine_")||t.match("showview_")||t.match("showplugin_")||t.match("pluginview_")||t.match("pluginattr_"))&&dmtRedrawCharts(),t.match("dmt_plugin_")&&dmtSetPluginMarginInfo(t)):dcOnMainPage("main")}function dmtGetAttrTypeInfoById(t){if(null==g_attr_type_list)return null;var e=dmtGetTypeInfo(g_attr_type_list.user_self_cust,t);return"null"!=e||"null"!=(e=dmtGetTypeInfo(g_attr_type_list.global_plug,t))?e:null}function dmtGetAttrTypeNameById(t){if(null==g_attr_type_list)return"未加载类型信息";var e=dmtGetAttrTypeInfoById(t);return null!=e?e.name:"监控点类型查找失败"}function dmtAddNoDataTextForView(t,e){var a=!1;$("#"+t+" a[ctid]").each(function(){var t,e="#"+$(this).attr("ctid");$(e).length<=0?(t=$(this).html(),$(this).html("<font class='chart_has_no_data_rep' color='blue'>&nbsp;[无上报]&nbsp;</font>"+t)):a=!0}),void 0===e||a?$("#"+t+" .chart_has_no_data_rep").each(function(){$(this).parent().parent().hide()}):dmtChartContainerEmpty("#"+e)}var dmtAddEvent=function(){function $g(t){var e=t.type;return"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),t.srcElement&&!t.target&&(t.target=t.srcElement),t.preventDefault||void 0===t.returnValue||(t.preventDefault=function(){t.returnValue=!1}),t}return window.addEventListener?function(t,e,a,r){"mousewheel"===e&&void 0!==document.mozHidden&&(e="DOMMouseScroll"),t.addEventListener(e,function(t){a.call(this,$g(t))},r||!1)}:window.attachEvent?function(e,t,a,r){e.attachEvent("on"+t,function(t){t=t||window.event,a.call(e,$g(t))})}:function(){}}();function dmtSortTable(t,a){var e,r,i;a=a||function(t,e,a){if(void 0!==t.attr("src_val")&&void 0!==e.attr("src_val")){var r=Number(t.attr("src_val")),i=Number(e.attr("src_val"));return a?i<r:r<i}var r=$.trim(t.text()).replace(/,|\s+|%/g,""),i=$.trim(e.text()).replace(/,|\s+|%/g,""),n=/^\d+(\.\d*)?$/;return n.test(r)&&n.test(i)&&(r=parseFloat(r),i=parseFloat(i)),a?i<r:r<i},i=(r="string"==typeof(e=t=t||"th.xrk_sortable")?$(e):e).closest("table"),r.click(function(){var t=$(this).index(),e=$(this).hasClass("asc");!function(t,e,a,r){var i=t.find("tr"),n=t.attr("sort_idx"),o=i.length;if(void 0===n){for(var l=0;l<o;l++){var s=(c=i.eq(l).find("td").eq(e)).text();c.html('<span class="xrk_text_bl">'+s+"</span>")}t.attr("sort_idx",e)}else if(n!=e){for(l=0;l<o;l++){var _=i.eq(l).find("td").eq(n),d=_.text();_.html(d);s=(c=i.eq(l).find("td").eq(e)).text();c.html('<span class="xrk_text_bl">'+s+"</span>")}t.attr("sort_idx",e)}for(l=0;l<o;l++){var c,s=(c=i.eq(l).find("td").eq(e)).text();c.html('<span class="xrk_text_bl">'+s+"</span>")}for(l=0;l<o-1;l++)for(var m,u=0;u<o-l-1;u++){a(i.eq(u).find("td").eq(e),i.eq(u+1).find("td").eq(e),r)&&(m=i.eq(u+1),i.eq(u).insertAfter(m),i=t.find("tr"))}}(i.find("tbody"),t,a,e),$(this).toggleClass("asc").toggleClass("desc")}),r.attr("title","点击排序")}